import{aP as yt,r as I,c as W,aX as G,x as i,y as r,z as t,O as h,L as D,P as a,u as e,C as R,K as ct,aq as ut,aa as mt,f as gt,Y as pt,Q as z,ac as H,B as tt,R as Y,o as xt,q as vt,aW as bt,V as _t,I as lt,J as ft,av as ht}from"./vue-vendor-Bsazo-x0.js";import{_ as Q,a as kt}from"./index-VMeRaDwr.js";import{L as $t}from"./LogoTitle-CHp2QlI4.js";import{T as wt}from"./ThemeToggle-B2Zl3goZ.js";import{b as St}from"./vendor-Dr8jvgFu.js";import{_ as Ct}from"./WindowCountdown-BTXjZ8Dc.js";import Tt from"./TutorialView-DU3t9N5o.js";import"./element-plus-CqiD73Lu.js";class Lt{constructor(){this.baseURL=window.location.origin,this.isDev=!1}async request(p,s={}){try{this.isDev&&p.startsWith("/admin")&&(p="/webapi"+p);const x=await fetch(`${this.baseURL}${p}`,{headers:{"Content-Type":"application/json",...s.headers},...s}),m=await x.json();if(!x.ok)throw new Error(m.message||`请求失败: ${x.status}`);return m}catch(x){throw console.error("API Stats request error:",x),x}}async getKeyId(p){return this.request("/apiStats/api/get-key-id",{method:"POST",body:JSON.stringify({apiKey:p})})}async getUserStats(p){return this.request("/apiStats/api/user-stats",{method:"POST",body:JSON.stringify({apiId:p})})}async getUserModelStats(p,s="daily"){return this.request("/apiStats/api/user-model-stats",{method:"POST",body:JSON.stringify({apiId:p,period:s})})}async getOemSettings(){try{return await this.request("/admin/oem-settings")}catch(p){return console.error("Failed to load OEM settings:",p),{success:!0,data:{siteName:"Claude Relay Service",siteIcon:"",siteIconData:""}}}}async getBatchStats(p){return this.request("/apiStats/api/batch-stats",{method:"POST",body:JSON.stringify({apiIds:p})})}async getBatchModelStats(p,s="daily"){return this.request("/apiStats/api/batch-model-stats",{method:"POST",body:JSON.stringify({apiIds:p,period:s})})}async getUsageLogs({apiId:p,apiKey:s,limit:x=50,offset:m=0}){const f={limit:x,offset:m};return p?f.apiId=p:s&&(f.apiKey=s),this.request("/apiStats/api/usage-logs",{method:"POST",body:JSON.stringify(f)})}}const V=new Lt,X=yt("apistats",()=>{const F=I(""),p=I(null),s=I(!1),x=I(!1),m=I(!0),f=I(""),u=I("daily"),v=I(null),b=I([]),M=I(null),y=I(null),S=I({siteName:"",siteIcon:"",siteIconData:""}),U=I(!1),w=I([]),k=I([]),d=I(null),o=I([]),P=I([]),N=W(()=>{const c={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};return U.value&&d.value?u.value==="daily"?d.value.dailyUsage||c:d.value.monthlyUsage||c:u.value==="daily"?M.value||c:y.value||c}),L=W(()=>{if(!v.value||!N.value)return{tokenUsage:0,costUsage:0,requestUsage:0};const c=N.value,_=v.value.limits;return{tokenUsage:_.tokenLimit>0?Math.min(c.allTokens/_.tokenLimit*100,100):0,costUsage:_.dailyCostLimit>0?Math.min(c.cost/_.dailyCostLimit*100,100):0,requestUsage:_.rateLimitRequests>0?Math.min(c.requests/_.rateLimitRequests*100,100):0}});async function $(){if(U.value)return at();const c=F.value.trim();if(!c){f.value="请输入 API Key";return}if(c.length<10||c.length>512){f.value="API Key 格式无效：长度应在 10-512 个字符之间";return}s.value=!0,f.value="",v.value=null,b.value=[],p.value=null;try{const _=await V.getKeyId(c);if(_.success){p.value=_.data.id;const K=await V.getUserStats(p.value);if(K.success)v.value=K.data,await A(),f.value="",ot();else throw new Error(K.message||"查询失败")}else throw new Error(_.message||"获取 API Key ID 失败")}catch(_){console.error("Query stats error:",_),f.value=_.message||"查询统计数据失败，请检查您的 API Key 是否正确",v.value=null,b.value=[],p.value=null}finally{s.value=!1}}async function A(){p.value&&(await Promise.all([O("daily"),O("monthly")]),await C(u.value))}async function O(c){try{const _=await V.getUserModelStats(p.value,c);if(_.success){const K=_.data||[],E={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};K.forEach(q=>{var B;E.requests+=q.requests||0,E.inputTokens+=q.inputTokens||0,E.outputTokens+=q.outputTokens||0,E.cacheCreateTokens+=q.cacheCreateTokens||0,E.cacheReadTokens+=q.cacheReadTokens||0,E.allTokens+=q.allTokens||0,E.cost+=((B=q.costs)==null?void 0:B.total)||0}),E.formattedCost=it(E.cost),c==="daily"?M.value=E:y.value=E}else console.warn(`Failed to load ${c} stats:`,_.message)}catch(_){console.error(`Load ${c} stats error:`,_)}}async function C(c="daily"){if(p.value){x.value=!0;try{const _=await V.getUserModelStats(p.value,c);if(_.success)b.value=_.data||[];else throw new Error(_.message||"加载模型统计失败")}catch(_){console.error("Load model stats error:",_),b.value=[]}finally{x.value=!1}}}async function Z(c){if(!(u.value===c||x.value)){if(u.value=c,U.value&&k.value.length>0){await et(c);return}(c==="daily"&&!M.value||c==="monthly"&&!y.value)&&await O(c),await C(c)}}async function J(){var c,_;if(p.value){s.value=!0,f.value="",v.value=null,b.value=[];try{const K=await V.getUserStats(p.value);if(K.success)v.value=K.data,console.log("API Stats - Full response:",K.data),console.log("API Stats - limits data:",K.data.limits),console.log("API Stats - weeklyOpusCostLimit:",(c=K.data.limits)==null?void 0:c.weeklyOpusCostLimit),console.log("API Stats - weeklyOpusCost:",(_=K.data.limits)==null?void 0:_.weeklyOpusCost),await A(),f.value="";else throw new Error(K.message||"查询失败")}catch(K){console.error("Load stats with apiId error:",K),f.value=K.message||"查询统计数据失败",v.value=null,b.value=[]}finally{s.value=!1}}}async function rt(){m.value=!0;try{const c=await V.getOemSettings();c&&c.success&&c.data&&(S.value={...S.value,...c.data})}catch(c){console.error("Error loading OEM settings:",c),S.value={siteName:"Claude Relay Service",siteIcon:"",siteIconData:""}}finally{m.value=!1}}function it(c){return typeof c!="number"||c===0?"$0.000000":c>=1?"$"+c.toFixed(2):c>=.01?"$"+c.toFixed(4):"$"+c.toFixed(6)}function ot(){if(p.value){const c=new URL(window.location);c.searchParams.set("apiId",p.value),window.history.pushState({},"",c)}}async function at(){const c=n();if(c.length===0){f.value="请输入至少一个有效的 API Key";return}s.value=!0,f.value="",d.value=null,o.value=[],P.value=[],b.value=[],w.value=c,k.value=[];try{const _=await Promise.allSettled(c.map(B=>V.getKeyId(B))),K=[],E=[];if(_.forEach((B,st)=>{B.status==="fulfilled"&&B.value.success?(K.push(B.value.data.id),E.push(c[st])):P.value.push(c[st])}),K.length===0)throw new Error("所有 API Key 都无效");k.value=K,w.value=E;const q=await V.getBatchStats(K);if(q.success)d.value=q.data.aggregated,o.value=q.data.individual,v.value=q.data.aggregated,M.value=q.data.aggregated.dailyUsage||null,y.value=q.data.aggregated.monthlyUsage||null,await et(u.value),l();else throw new Error(q.message||"批量查询失败")}catch(_){console.error("Batch query error:",_),f.value=_.message||"批量查询统计数据失败",d.value=null,o.value=[]}finally{s.value=!1}}async function et(c="daily"){if(k.value.length!==0){x.value=!0;try{const _=await V.getBatchModelStats(k.value,c);if(_.success)b.value=_.data||[];else throw new Error(_.message||"加载批量模型统计失败")}catch(_){console.error("Load batch model stats error:",_),b.value=[]}finally{x.value=!1}}}function n(){if(!F.value)return[];const c=F.value.split(/[,\n]+/).map(K=>K.trim()).filter(K=>K.length>=10&&K.length<=512);return[...new Set(c)].slice(0,30)}function l(){if(k.value.length>0){const c=new URL(window.location);c.searchParams.set("apiIds",k.value.join(",")),c.searchParams.set("batch","true"),window.history.pushState({},"",c)}}function g(){F.value=""}function T(){v.value=null,b.value=[],M.value=null,y.value=null,f.value="",u.value="daily",p.value=null,w.value=[],k.value=[],d.value=null,o.value=[],P.value=[]}function j(){F.value="",U.value=!1,T()}return{apiKey:F,apiId:p,loading:s,modelStatsLoading:x,oemLoading:m,error:f,statsPeriod:u,statsData:v,modelStats:b,dailyStats:M,monthlyStats:y,oemSettings:S,multiKeyMode:U,apiKeys:w,apiIds:k,aggregatedStats:d,individualStats:o,invalidKeys:P,currentPeriodData:N,usagePercentages:L,queryStats:$,queryBatchStats:at,loadAllPeriodStats:A,loadPeriodStats:O,loadModelStats:C,loadBatchModelStats:et,switchPeriod:Z,loadStatsWithApiId:J,loadOemSettings:rt,clearData:T,clearInput:g,reset:j}}),Kt={class:"api-input-wide-card mb-8 rounded-3xl p-6 shadow-xl"},Pt={class:"mx-auto max-w-4xl"},Mt={class:"control-bar mb-4 flex flex-wrap items-center justify-between gap-3"},At={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},It={class:"button-group flex items-center gap-2"},Dt={class:"mode-switch-group flex items-center rounded-lg bg-gray-100 p-1 dark:bg-gray-800"},qt={key:0,class:"ml-1 rounded-full bg-white/20 px-1.5 py-0.5 text-xs font-semibold"},Ut={class:"api-input-grid grid grid-cols-1 gap-4 lg:grid-cols-4"},Rt={class:"lg:col-span-3"},Ot=["disabled"],jt={key:1,class:"relative"},Nt=["disabled"],Et={class:"lg:col-span-1"},Ft=["disabled"],Wt={key:0,class:"fas fa-spinner loading-spinner"},Bt={key:1,class:"fas fa-search"},Vt={class:"security-notice mt-4"},zt={key:0,class:"mt-2 rounded-lg bg-blue-50 p-3 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-400"},Jt={__name:"ApiKeyInput",setup(F){const p=X(),{apiKey:s,loading:x,multiKeyMode:m}=G(p),{queryStats:f,clearInput:u}=p,v=W(()=>{if(!m.value||!s.value)return[];const M=s.value.split(/[,\n]+/).map(S=>S.trim()).filter(S=>S.length>0);return[...new Set(M)].slice(0,30)}),b=W(()=>m.value?v.value.length>0:s.value&&s.value.trim().length>0);return(M,y)=>(r(),i("div",Kt,[y[15]||(y[15]=t("div",{class:"wide-card-title mb-6"},[t("h2",{class:"mb-2 text-2xl font-bold text-gray-900 dark:text-gray-200"},[t("i",{class:"fas fa-chart-line mr-3"}),h(" 使用统计查询 ")]),t("p",{class:"text-base text-gray-600 dark:text-gray-400"},"查询您的 API Key 使用情况和统计数据")],-1)),t("div",Pt,[t("div",Mt,[t("label",At,[y[8]||(y[8]=t("i",{class:"fas fa-key mr-2"},null,-1)),h(" "+a(e(m)?"输入您的 API Keys（每行一个或用逗号分隔）":"输入您的 API Key"),1)]),t("div",It,[t("div",Dt,[t("button",{class:R(["mode-switch-btn",{active:!e(m)}]),title:"单一模式",onClick:y[0]||(y[0]=S=>m.value=!1)},y[9]||(y[9]=[t("i",{class:"fas fa-key"},null,-1),t("span",{class:"ml-2 hidden sm:inline"},"单一",-1)]),2),t("button",{class:R(["mode-switch-btn",{active:e(m)}]),title:"聚合模式",onClick:y[1]||(y[1]=S=>m.value=!0)},[y[10]||(y[10]=t("i",{class:"fas fa-layer-group"},null,-1)),y[11]||(y[11]=t("span",{class:"ml-2 hidden sm:inline"},"聚合",-1)),e(m)&&v.value.length>0?(r(),i("span",qt,a(v.value.length),1)):D("",!0)],2)])])]),t("div",Ut,[t("div",Rt,[e(m)?(r(),i("div",jt,[ct(t("textarea",{"onUpdate:modelValue":y[4]||(y[4]=S=>gt(s)?s.value=S:null),class:"wide-card-input w-full resize-y",disabled:e(x),placeholder:`请输入您的 API Keys，支持以下格式：
cr_xxx
cr_yyy
或
cr_xxx, cr_yyy`,rows:"4",onKeyup:y[5]||(y[5]=mt(pt((...S)=>e(f)&&e(f)(...S),["ctrl"]),["enter"]))},null,40,Nt),[[ut,e(s)]]),e(s)&&!e(x)?(r(),i("button",{key:0,class:"absolute right-2 top-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",title:"清空输入",onClick:y[6]||(y[6]=(...S)=>e(u)&&e(u)(...S))},y[12]||(y[12]=[t("i",{class:"fas fa-times-circle"},null,-1)]))):D("",!0)])):ct((r(),i("input",{key:0,"onUpdate:modelValue":y[2]||(y[2]=S=>gt(s)?s.value=S:null),class:"wide-card-input w-full",disabled:e(x),placeholder:"请输入您的 API Key (cr_...)",type:"password",onKeyup:y[3]||(y[3]=mt((...S)=>e(f)&&e(f)(...S),["enter"]))},null,40,Ot)),[[ut,e(s)]])]),t("div",Et,[t("button",{class:"btn btn-primary btn-query flex h-full w-full items-center justify-center gap-2",disabled:e(x)||!b.value,onClick:y[7]||(y[7]=(...S)=>e(f)&&e(f)(...S))},[e(x)?(r(),i("i",Wt)):(r(),i("i",Bt)),h(" "+a(e(x)?"查询中...":"查询统计"),1)],8,Ft)])]),t("div",Vt,[y[13]||(y[13]=t("i",{class:"fas fa-shield-alt mr-2"},null,-1)),h(" "+a(e(m)?"您的 API Keys 仅用于查询统计数据，不会被存储。聚合模式下部分个体化信息将不显示。":"您的 API Key 仅用于查询自己的统计数据，不会被存储或用于其他用途"),1)]),e(m)?(r(),i("div",zt,y[14]||(y[14]=[t("i",{class:"fas fa-lightbulb mr-2"},null,-1),t("span",null,"提示：最多支持同时查询 30 个 API Keys。使用 Ctrl+Enter 快速查询。",-1)]))):D("",!0)])]))}},Yt=Q(Jt,[["__scopeId","data-v-11e74200"]]),Ht={class:"space-y-6 md:space-y-8"},Gt={class:"grid grid-cols-1 items-stretch gap-4 md:gap-6 xl:grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)]"},Qt={class:"card-section"},Xt={class:"section-header"},Zt={class:"header-title"},te={key:0,class:"info-grid"},ee={class:"info-item"},se={class:"info-value"},ae={class:"info-item"},le={class:"info-value text-green-600 dark:text-emerald-400"},re={key:0,class:"info-item"},ie={class:"info-value text-red-500 dark:text-red-400"},oe={class:"info-item"},ne={class:"info-value"},de={class:"info-item"},ce={class:"info-value"},ue={class:"info-item"},me={class:"info-value text-indigo-600 dark:text-indigo-300"},ge={key:1,class:"info-item xl:col-span-2"},fe={class:"space-y-2"},xe={class:"truncate"},ye={class:"font-semibold"},pe={key:1,class:"info-grid"},ve={class:"info-item"},be={class:"info-value break-all"},_e={class:"info-item"},he={class:"info-item"},ke={class:"info-value"},$e={class:"info-item"},we={class:"info-value break-all"},Se={class:"info-item xl:col-span-2"},Ce={class:"info-value"},Te={class:"ml-2 text-xs text-gray-500 dark:text-gray-400"},Le={key:0,class:"text-red-500 dark:text-red-400"},Ke={key:1,class:"text-orange-500 dark:text-orange-400"},Pe={key:2},Me={key:2,class:"text-gray-400 dark:text-gray-500"},Ae={class:"card-section"},Ie={class:"section-header"},De={class:"header-tag"},qe={class:"metric-grid"},Ue={class:"metric-card"},Re={class:"metric-value text-green-600 dark:text-emerald-300"},Oe={class:"metric-label"},je={class:"metric-card"},Ne={class:"metric-value text-blue-600 dark:text-sky-300"},Ee={class:"metric-label"},Fe={class:"metric-card"},We={class:"metric-value text-purple-600 dark:text-violet-300"},Be={class:"metric-label"},Ve={class:"metric-card"},ze={class:"metric-value text-amber-500 dark:text-amber-300"},Je={class:"metric-label"},Ye={key:0,class:"card-section"},He={class:"flex items-center justify-between gap-3"},Ge={class:"flex items-center gap-3"},Qe={class:"account-name"},Xe={class:"account-sub"},Ze={key:0,class:"mt-3 space-y-2"},ts={class:"progress-row"},es={class:"progress-track"},ss={class:"progress-value"},as={class:"flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},ls={key:0,class:"font-medium text-indigo-600 dark:text-indigo-400"},rs={key:1,class:"mt-3"},is={key:0,class:"space-y-2"},os={class:"quota-header"},ns={class:"quota-percent"},ds={class:"progress-track"},cs={class:"quota-foot"},us={key:1,class:"rounded-xl bg-slate-100 px-3 py-2 text-xs text-slate-500 dark:bg-slate-800 dark:text-slate-300"},ms={__name:"StatsOverview",setup(F){const p=X(),{statsData:s,statsPeriod:x,currentPeriodData:m,multiKeyMode:f,aggregatedStats:u,individualStats:v,invalidKeys:b}=G(p),M=W(()=>!v.value||v.value.length===0?[]:[...v.value].sort((n,l)=>{var g,T;return(((g=l.usage)==null?void 0:g.allTokens)||0)-(((T=n.usage)==null?void 0:T.allTokens)||0)}).slice(0,3)),y=n=>{var g;return!u.value||!u.value.usage.allTokens?0:((((g=n.usage)==null?void 0:g.allTokens)||0)/u.value.usage.allTokens*100).toFixed(1)},S=n=>{if(!n)return"无";try{return St(n).format("YYYY年MM月DD日 HH:mm")}catch{return"格式错误"}},U=n=>n?new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",w=n=>n?new Date(n)<new Date:!1,k=n=>{if(!n)return!1;const T=(new Date(n)-new Date)/(1e3*60*60*24);return T>0&&T<=7},d=n=>(typeof n!="number"&&(n=parseInt(n)||0),n===0?"0":n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":n.toLocaleString()),o=n=>({claude:"Claude",gemini:"Gemini",all:"全部模型"})[n]||n||"未知",P=W(()=>{var g,T;const n=(T=(g=s.value)==null?void 0:g.accounts)==null?void 0:T.details;if(!n)return[];const l=[];return n.claude&&n.claude.accountType==="dedicated"&&l.push({key:"claude",...n.claude}),n.openai&&n.openai.accountType==="dedicated"&&l.push({key:"openai",...n.openai}),l}),N=W(()=>{const n=P.value.length;return n<=1?"md:grid-cols-1 lg:grid-cols-1":n===2?"md:grid-cols-2":"md:grid-cols-2 xl:grid-cols-3"}),L=n=>n?n.platform==="openai"?"OpenAI 专属账号":"Claude 专属账号":"专属账号",$=n=>{if(!n||n<=0)return"";const l=Math.floor(n),g=Math.floor(l/1440),T=Math.floor(l%1440/60),j=l%60;return g>0?T>0?`${g}天${T}小时`:`${g}天`:T>0?j>0?`${T}小时${j}分钟`:`${T}小时`:`${j}分钟`},A=n=>{if(!n)return{text:"状态未知",class:"text-gray-400"};if(n.isRateLimited){const l=$(n.minutesRemaining);return{text:`限流中${l?` · 剩余约 ${l}`:""}`,class:"text-red-500 dark:text-red-400"}}return{text:"未限流",class:"text-green-600 dark:text-emerald-400"}},O=(n,l)=>{if(!n||!l)return"暂无时间窗口信息";const g=new Date(n),T=new Date(l),j=c=>`${`${c.getHours()}`.padStart(2,"0")}:${`${c.getMinutes()}`.padStart(2,"0")}`;return`${j(g)} - ${j(T)}`},C=n=>{if(!n||n<=0)return"";const l=Math.floor(n/60),g=n%60;return l>0?`${l}小时${g}分钟`:`${g}分钟`},Z=(n,l)=>{var T;if(!n)return"bg-gradient-to-r from-blue-500 to-indigo-500";if((T=l==null?void 0:l.rateLimitStatus)!=null&&T.isRateLimited)return"bg-gradient-to-r from-red-500 to-red-600";const g=String(n).toLowerCase();return g==="rejected"?"bg-gradient-to-r from-red-500 to-red-600":g==="allowed_warning"?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-blue-500 to-indigo-500"},J=n=>{if(!n)return null;const l=typeof n.usedPercent=="number"&&!Number.isNaN(n.usedPercent)?n.usedPercent:null,g=typeof n.resetAfterSeconds=="number"&&!Number.isNaN(n.resetAfterSeconds)?n.resetAfterSeconds:null,T=typeof n.remainingSeconds=="number"?n.remainingSeconds:null,j=n.resetAt?Date.parse(n.resetAt):null;return g!==null&&(T!==null&&T<=0||j!==null&&!Number.isNaN(j)&&Date.now()>=j)?0:l===null?null:Math.max(0,Math.min(100,l))},rt=n=>{const l=J(n);return l===null?"bg-gradient-to-r from-gray-300 to-gray-400":l>=90?"bg-gradient-to-r from-red-500 to-red-600":l>=75?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-emerald-500 to-teal-500"},it=n=>{const l=J(n);return l===null?"0%":`${l}%`},ot=n=>{const l=J(n);return l===null?"--":`${l.toFixed(1)}%`},at=n=>{if(!n)return"--";let l=n.remainingSeconds;if(l==null&&(l=n.resetAfterSeconds),l==null||Number.isNaN(Number(l)))return"--";l=Math.max(0,Math.floor(Number(l)));const g=Math.floor(l/86400),T=Math.floor(l%86400/3600),j=Math.floor(l%3600/60),c=l%60;return g>0?T>0?`${g}天${T}小时`:`${g}天`:T>0?j>0?`${T}小时${j}分钟`:`${T}小时`:j>0?`${j}分钟`:`${c}秒`},et=n=>n==="secondary"?"周限":"5h";return(n,l)=>(r(),i("div",Ht,[t("div",Gt,[t("div",Qt,[t("header",Xt,[t("i",{class:R(["header-icon",e(f)?"fas fa-layer-group text-purple-500":"fas fa-info-circle text-blue-500"])},null,2),t("h3",Zt,a(e(f)?"批量查询概要":"API Key 信息"),1)]),e(f)&&e(u)?(r(),i("div",te,[t("div",ee,[l[0]||(l[0]=t("p",{class:"info-label"},"查询 Keys 数",-1)),t("p",se,a(e(u).totalKeys)+" 个",1)]),t("div",ae,[l[2]||(l[2]=t("p",{class:"info-label"},"有效 Keys 数",-1)),t("p",le,[l[1]||(l[1]=t("i",{class:"fas fa-check-circle mr-1"},null,-1)),h(a(e(u).activeKeys)+" 个 ",1)])]),e(b).length>0?(r(),i("div",re,[l[4]||(l[4]=t("p",{class:"info-label"},"无效 Keys 数",-1)),t("p",ie,[l[3]||(l[3]=t("i",{class:"fas fa-times-circle mr-1"},null,-1)),h(a(e(b).length)+" 个 ",1)])])):D("",!0),t("div",oe,[l[5]||(l[5]=t("p",{class:"info-label"},"总请求数",-1)),t("p",ne,a(d(e(u).usage.requests)),1)]),t("div",de,[l[6]||(l[6]=t("p",{class:"info-label"},"总 Token 数",-1)),t("p",ce,a(d(e(u).usage.allTokens)),1)]),t("div",ue,[l[7]||(l[7]=t("p",{class:"info-label"},"总费用",-1)),t("p",me,a(e(u).usage.formattedCost),1)]),e(v).length>1?(r(),i("div",ge,[l[8]||(l[8]=t("p",{class:"info-label"},"Top 3 贡献占比",-1)),t("div",fe,[(r(!0),i(z,null,H(M.value,g=>(r(),i("div",{key:g.apiId,class:"contributor-item"},[t("span",xe,a(g.name),1),t("span",ye,a(y(g))+"%",1)]))),128))])])):D("",!0)])):(r(),i("div",pe,[t("div",ve,[l[9]||(l[9]=t("p",{class:"info-label"},"名称",-1)),t("p",be,a(e(s).name),1)]),t("div",_e,[l[10]||(l[10]=t("p",{class:"info-label"},"状态",-1)),t("p",{class:R(["info-value font-semibold",e(s).isActive?"text-green-600 dark:text-emerald-400":"text-red-500 dark:text-red-400"])},[t("i",{class:R(["mr-1",e(s).isActive?"fas fa-check-circle":"fas fa-times-circle"])},null,2),h(" "+a(e(s).isActive?"活跃":"已停用"),1)],2)]),t("div",he,[l[11]||(l[11]=t("p",{class:"info-label"},"权限",-1)),t("p",ke,a(o(e(s).permissions)),1)]),t("div",$e,[l[12]||(l[12]=t("p",{class:"info-label"},"创建时间",-1)),t("p",we,a(S(e(s).createdAt)),1)]),t("div",Se,[l[17]||(l[17]=t("p",{class:"info-label"},"过期时间",-1)),t("div",Ce,[e(s).expirationMode==="activation"&&!e(s).isActivated?(r(),i(z,{key:0},[l[13]||(l[13]=t("span",{class:"text-amber-600 dark:text-amber-400"},[t("i",{class:"fas fa-pause-circle mr-1"}),h("未激活 ")],-1)),t("span",Te," 首次使用后 "+a(e(s).activationDays||(e(s).activationUnit==="hours"?24:30))+" "+a(e(s).activationUnit==="hours"?"小时":"天")+"过期 ",1)],64)):e(s).expiresAt?(r(),i(z,{key:1},[w(e(s).expiresAt)?(r(),i("span",Le,l[14]||(l[14]=[t("i",{class:"fas fa-exclamation-circle mr-1"},null,-1),h("已过期 ",-1)]))):k(e(s).expiresAt)?(r(),i("span",Ke,[l[15]||(l[15]=t("i",{class:"fas fa-clock mr-1"},null,-1)),h(a(U(e(s).expiresAt)),1)])):(r(),i("span",Pe,a(U(e(s).expiresAt)),1))],64)):(r(),i("span",Me,l[16]||(l[16]=[t("i",{class:"fas fa-infinity mr-1"},null,-1),h("永不过期 ",-1)])))])])]))]),t("div",Ae,[t("header",Ie,[l[18]||(l[18]=t("i",{class:"header-icon fas fa-chart-bar text-green-500"},null,-1)),l[19]||(l[19]=t("h3",{class:"header-title"},"使用统计概览",-1)),t("span",De,a(e(x)==="daily"?"今日":"本月"),1)]),t("div",qe,[t("div",Ue,[t("p",Re,a(d(e(m).requests)),1),t("p",Oe,a(e(x)==="daily"?"今日":"本月")+"请求数",1)]),t("div",je,[t("p",Ne,a(d(e(m).allTokens)),1),t("p",Ee,a(e(x)==="daily"?"今日":"本月")+"Token 数",1)]),t("div",Fe,[t("p",We,a(e(m).formattedCost||"$0.000000"),1),t("p",Be,a(e(x)==="daily"?"今日":"本月")+"费用",1)]),t("div",Ve,[t("p",ze,a(d(e(m).inputTokens)),1),t("p",Je,a(e(x)==="daily"?"今日":"本月")+"输入 Token",1)])])])]),!e(f)&&P.value.length>0?(r(),i("div",Ye,[l[21]||(l[21]=t("header",{class:"section-header"},[t("i",{class:"header-icon fas fa-plug text-indigo-500"}),t("h3",{class:"header-title"},"专属账号运行状态"),t("span",{class:"header-tag"},"实时更新")],-1)),t("div",{class:R(["grid grid-cols-1 gap-4",N.value])},[(r(!0),i(z,null,H(P.value,g=>{var T,j,c,_,K,E;return r(),i("div",{key:g.id||g.key,class:"account-card"},[t("div",He,[t("div",Ge,[t("span",{class:R(["account-icon",g.platform==="claude"?"icon-claude":"icon-openai"])},[t("i",{class:R(g.platform==="claude"?"fas fa-meteor":"fas fa-robot")},null,2)],2),t("div",null,[t("p",Qe,a(L(g)),1),t("p",Xe,a(g.platform==="claude"?"会话窗口":"额度窗口"),1)])]),A(g.rateLimitStatus)?(r(),i("div",{key:0,class:R(["rate-badge",A(g.rateLimitStatus).class])},[l[20]||(l[20]=t("i",{class:"fas fa-tachometer-alt mr-1"},null,-1)),h(" "+a(A(g.rateLimitStatus).text),1)],2)):D("",!0)]),g.platform==="claude"?(r(),i("div",Ze,[t("div",ts,[t("div",es,[t("div",{class:R(["progress-bar",Z((T=g.sessionWindow)==null?void 0:T.sessionWindowStatus,g)]),style:tt({width:`${Math.min(100,Math.max(0,((j=g.sessionWindow)==null?void 0:j.progress)||0))}%`})},null,6)]),t("span",ss,a(Math.min(100,Math.max(0,Math.round(((c=g.sessionWindow)==null?void 0:c.progress)||0))))+"% ",1)]),t("div",as,[t("span",null,a(O((_=g.sessionWindow)==null?void 0:_.windowStart,(K=g.sessionWindow)==null?void 0:K.windowEnd)),1),((E=g.sessionWindow)==null?void 0:E.remainingTime)>0?(r(),i("span",ls," 剩余 "+a(C(g.sessionWindow.remainingTime)),1)):D("",!0)])])):g.platform==="openai"?(r(),i("div",rs,[g.codexUsage?(r(),i("div",is,[(r(),i(z,null,H(["primary","secondary"],q=>{var B,st,nt,dt;return t("div",{key:`${g.key}-${q}`,class:"quota-row"},[t("div",os,[t("span",{class:R(["quota-tag",q==="primary"?"tag-indigo":"tag-blue"])},a(et(q)),3),t("span",ns,a(ot((B=g.codexUsage)==null?void 0:B[q])),1)]),t("div",ds,[t("div",{class:R(["progress-bar",rt((st=g.codexUsage)==null?void 0:st[q])]),style:tt({width:it((nt=g.codexUsage)==null?void 0:nt[q])})},null,6)]),t("div",cs," 重置剩余 "+a(at((dt=g.codexUsage)==null?void 0:dt[q])),1)])}),64))])):(r(),i("p",us," 暂无额度使用数据 "))])):D("",!0)])}),128))],2)])):D("",!0)]))}},gs=Q(ms,[["__scopeId","data-v-b72df2cd"]]),fs={class:"card p-4 md:p-6"},xs={class:"mb-3 flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:mb-4 md:text-xl"},ys={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},ps={class:"space-y-2 md:space-y-3"},vs={class:"flex items-center justify-between"},bs={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},_s={class:"flex items-center justify-between"},hs={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},ks={class:"flex items-center justify-between"},$s={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},ws={class:"flex items-center justify-between"},Ss={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},Cs={class:"mt-3 border-t border-gray-200 pt-3 dark:border-gray-700 md:mt-4 md:pt-4"},Ts={class:"flex items-center justify-between font-bold text-gray-900 dark:text-gray-100"},Ls={class:"text-sm md:text-base"},Ks={class:"text-lg md:text-xl"},Ps={__name:"TokenDistribution",setup(F){const p=X(),{statsPeriod:s,currentPeriodData:x}=G(p),m=f=>(typeof f!="number"&&(f=parseInt(f)||0),f===0?"0":f>=1e6?(f/1e6).toFixed(1)+"M":f>=1e3?(f/1e3).toFixed(1)+"K":f.toLocaleString());return(f,u)=>(r(),i("div",fs,[t("h3",xs,[u[0]||(u[0]=t("span",{class:"flex items-center"},[t("i",{class:"fas fa-coins mr-2 text-sm text-yellow-500 md:mr-3 md:text-base"}),h(" Token 使用分布 ")],-1)),t("span",ys,"("+a(e(s)==="daily"?"今日":"本月")+")",1)]),t("div",ps,[t("div",vs,[u[1]||(u[1]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-arrow-right mr-1 text-xs text-green-500 md:mr-2 md:text-sm"}),h(" 输入 Token ")],-1)),t("span",bs,a(m(e(x).inputTokens)),1)]),t("div",_s,[u[2]||(u[2]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-arrow-left mr-1 text-xs text-blue-500 md:mr-2 md:text-sm"}),h(" 输出 Token ")],-1)),t("span",hs,a(m(e(x).outputTokens)),1)]),t("div",ks,[u[3]||(u[3]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-save mr-1 text-xs text-purple-500 md:mr-2 md:text-sm"}),h(" 缓存创建 Token ")],-1)),t("span",$s,a(m(e(x).cacheCreateTokens)),1)]),t("div",ws,[u[4]||(u[4]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-download mr-1 text-xs text-orange-500 md:mr-2 md:text-sm"}),h(" 缓存读取 Token ")],-1)),t("span",Ss,a(m(e(x).cacheReadTokens)),1)])]),t("div",Cs,[t("div",Ts,[t("span",Ls,a(e(s)==="daily"?"今日":"本月")+"总计",1),t("span",Ks,a(m(e(x).allTokens)),1)])])]))}},Ms=Q(Ps,[["__scopeId","data-v-d9e5c1dd"]]),As={class:"flex h-full flex-col gap-4 md:gap-6"},Is={class:"card flex h-full flex-col p-4 md:p-6"},Ds={class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},qs={key:0,class:"space-y-4"},Us={class:"rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:from-blue-900/20 dark:to-indigo-900/20"},Rs={class:"mb-3 flex items-center justify-between"},Os={class:"rounded-full bg-blue-100 px-2 py-1 text-xs font-semibold text-blue-700 dark:bg-blue-800 dark:text-blue-200"},js={class:"grid grid-cols-2 gap-3"},Ns={class:"text-center"},Es={class:"text-lg font-bold text-gray-900 dark:text-gray-100"},Fs={class:"text-center"},Ws={class:"text-lg font-bold text-green-600"},Bs={class:"rounded-lg bg-gradient-to-r from-purple-50 to-pink-50 p-4 dark:from-purple-900/20 dark:to-pink-900/20"},Vs={class:"space-y-2"},zs={class:"flex items-center justify-between"},Js={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Ys={class:"flex items-center justify-between"},Hs={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Gs={class:"flex items-center justify-between"},Qs={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Xs={key:0,class:"rounded-lg bg-red-50 p-3 text-sm dark:bg-red-900/20"},Zs={class:"text-red-700 dark:text-red-300"},ta={key:1,class:"space-y-4 md:space-y-5"},ea={class:"mb-2 flex items-center justify-between"},sa={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},aa={key:0},la={key:1,class:"flex items-center gap-1"},ra={key:0,class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},ia={key:1,class:"h-2 w-full rounded-full bg-gray-200"},oa={class:"mb-2 flex items-center justify-between"},na={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},da={key:0},ca={key:1,class:"flex items-center gap-1"},ua={key:0,class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},ma={key:1,class:"h-2 w-full rounded-full bg-gray-200"},ga={key:0},fa={class:"mb-2 flex items-center justify-between"},xa={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},ya={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},pa={key:1},va={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},ba={key:0},_a={key:1},ha={key:2},ka={class:"space-y-4 border-t border-gray-100 pt-3 dark:border-gray-700"},$a={class:"flex items-center justify-between"},wa={class:"text-sm font-medium text-gray-900 md:text-base"},Sa={key:0},Ca={key:1,class:"flex items-center gap-1"},Ta={class:"flex items-center justify-between"},La={class:"text-sm font-medium text-gray-900 md:text-base"},Ka={key:0,class:"text-orange-600"},Pa={key:1,class:"text-green-600"},Ma={class:"space-y-2"},Aa={class:"flex items-center justify-between"},Ia={class:"text-sm font-medium text-gray-900 md:text-base"},Da={key:0,class:"text-orange-600"},qa={key:1,class:"text-green-600"},Ua={key:0,class:"flex flex-wrap gap-2 rounded-lg bg-blue-50 p-2 dark:bg-blue-900/20 md:p-3"},Ra={key:0,class:"card p-4 md:p-6"},Oa={class:"rounded-lg border border-amber-200 bg-amber-50 p-3 dark:border-amber-800 dark:bg-amber-900/20 md:p-4"},ja={class:"space-y-1 md:space-y-2"},Na={class:"break-all text-gray-800 dark:text-gray-200"},Ea={__name:"LimitConfig",setup(F){const p=X(),{statsData:s,multiKeyMode:x,aggregatedStats:m,invalidKeys:f}=G(p),u=W(()=>{var o;const d=(o=s.value)==null?void 0:o.restrictions;return d?d.enableModelRestriction===!0&&Array.isArray(d.restrictedModels)&&d.restrictedModels.length>0:!1}),v=W(()=>{var o;const d=(o=s.value)==null?void 0:o.restrictions;return d?d.enableClientRestriction===!0&&Array.isArray(d.allowedClients)&&d.allowedClients.length>0:!1}),b=()=>{if(!s.value.limits.dailyCostLimit||s.value.limits.dailyCostLimit===0)return 0;const d=s.value.limits.currentDailyCost/s.value.limits.dailyCostLimit*100;return Math.min(d,100)},M=()=>{const d=b();return d>=100?"bg-red-500":d>=80?"bg-yellow-500":"bg-green-500"},y=()=>{if(!s.value.limits.totalCostLimit||s.value.limits.totalCostLimit===0)return 0;const d=s.value.limits.currentTotalCost/s.value.limits.totalCostLimit*100;return Math.min(d,100)},S=()=>{const d=y();return d>=100?"bg-red-500":d>=80?"bg-yellow-500":"bg-blue-500"},U=()=>{if(!s.value.limits.weeklyOpusCostLimit||s.value.limits.weeklyOpusCostLimit===0)return 0;const d=s.value.limits.weeklyOpusCost/s.value.limits.weeklyOpusCostLimit*100;return Math.min(d,100)},w=()=>{const d=U();return d>=100?"bg-red-500":d>=80?"bg-yellow-500":"bg-indigo-500"},k=d=>(typeof d!="number"&&(d=parseInt(d)||0),d===0?"0":d>=1e6?(d/1e6).toFixed(1)+"M":d>=1e3?(d/1e3).toFixed(1)+"K":d.toLocaleString());return(d,o)=>(r(),i("div",As,[t("div",Is,[t("h3",Ds,[o[0]||(o[0]=t("i",{class:"fas fa-shield-alt mr-2 text-sm text-red-500 md:mr-3 md:text-base"},null,-1)),h(" "+a(e(x)?"限制配置（聚合查询模式）":"限制配置"),1)]),e(x)&&e(m)?(r(),i("div",qs,[t("div",Us,[t("div",Rs,[o[1]||(o[1]=t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-layer-group mr-2 text-blue-500"}),h(" API Keys 概况 ")],-1)),t("span",Os,a(e(m).activeKeys)+"/"+a(e(m).totalKeys),1)]),t("div",js,[t("div",Ns,[t("div",Es,a(e(m).totalKeys),1),o[2]||(o[2]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"总计 Keys",-1))]),t("div",Fs,[t("div",Ws,a(e(m).activeKeys),1),o[3]||(o[3]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"激活 Keys",-1))])])]),t("div",Bs,[o[7]||(o[7]=t("div",{class:"mb-3 flex items-center"},[t("i",{class:"fas fa-chart-pie mr-2 text-purple-500"}),t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"聚合统计摘要")],-1)),t("div",Vs,[t("div",zs,[o[4]||(o[4]=t("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[t("i",{class:"fas fa-database mr-1 text-gray-400"}),h(" 总请求数 ")],-1)),t("span",Js,a(k(e(m).usage.requests)),1)]),t("div",Ys,[o[5]||(o[5]=t("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[t("i",{class:"fas fa-coins mr-1 text-yellow-500"}),h(" 总 Tokens ")],-1)),t("span",Hs,a(k(e(m).usage.allTokens)),1)]),t("div",Gs,[o[6]||(o[6]=t("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[t("i",{class:"fas fa-dollar-sign mr-1 text-green-500"}),h(" 总费用 ")],-1)),t("span",Qs,a(e(m).usage.formattedCost),1)])])]),e(f)&&e(f).length>0?(r(),i("div",Xs,[o[8]||(o[8]=t("i",{class:"fas fa-exclamation-triangle mr-2 text-red-600 dark:text-red-400"},null,-1)),t("span",Zs,a(e(f).length)+" 个无效的 API Key ",1)])):D("",!0),o[9]||(o[9]=t("div",{class:"rounded-lg bg-gray-50 p-3 text-xs text-gray-600 dark:bg-gray-800 dark:text-gray-400"},[t("i",{class:"fas fa-info-circle mr-1"}),h(" 每个 API Key 有独立的限制设置，聚合模式下不显示单个限制配置 ")],-1))])):D("",!0),e(x)?D("",!0):(r(),i("div",ta,[t("div",null,[t("div",ea,[o[11]||(o[11]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"每日费用限制",-1)),t("span",sa,[e(s).limits.dailyCostLimit>0?(r(),i("span",aa," $"+a(e(s).limits.currentDailyCost.toFixed(4))+" / $"+a(e(s).limits.dailyCostLimit.toFixed(2)),1)):(r(),i("span",la,[h(" $"+a(e(s).limits.currentDailyCost.toFixed(4))+" / ",1),o[10]||(o[10]=t("i",{class:"fas fa-infinity"},null,-1))]))])]),e(s).limits.dailyCostLimit>0?(r(),i("div",ra,[t("div",{class:R(["h-2 rounded-full transition-all duration-300",M()]),style:tt({width:b()+"%"})},null,6)])):(r(),i("div",ia,o[12]||(o[12]=[t("div",{class:"h-2 rounded-full bg-green-500",style:{width:"0%"}},null,-1)])))]),t("div",null,[t("div",oa,[o[14]||(o[14]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"总费用限制",-1)),t("span",na,[e(s).limits.totalCostLimit>0?(r(),i("span",da," $"+a(e(s).limits.currentTotalCost.toFixed(4))+" / $"+a(e(s).limits.totalCostLimit.toFixed(2)),1)):(r(),i("span",ca,[h(" $"+a(e(s).limits.currentTotalCost.toFixed(4))+" / ",1),o[13]||(o[13]=t("i",{class:"fas fa-infinity"},null,-1))]))])]),e(s).limits.totalCostLimit>0?(r(),i("div",ua,[t("div",{class:R(["h-2 rounded-full transition-all duration-300",S()]),style:tt({width:y()+"%"})},null,6)])):(r(),i("div",ma,o[15]||(o[15]=[t("div",{class:"h-2 rounded-full bg-blue-500",style:{width:"0%"}},null,-1)])))]),e(s).limits.weeklyOpusCostLimit>0?(r(),i("div",ga,[t("div",fa,[o[16]||(o[16]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"Opus 模型周费用限制",-1)),t("span",xa," $"+a(e(s).limits.weeklyOpusCost.toFixed(4))+" / $"+a(e(s).limits.weeklyOpusCostLimit.toFixed(2)),1)]),t("div",ya,[t("div",{class:R(["h-2 rounded-full transition-all duration-300",w()]),style:tt({width:U()+"%"})},null,6)])])):D("",!0),e(s).limits.rateLimitWindow>0&&(e(s).limits.rateLimitRequests>0||e(s).limits.tokenLimit>0||e(s).limits.rateLimitCost>0)?(r(),i("div",pa,[Y(Ct,{"cost-limit":e(s).limits.rateLimitCost,"current-cost":e(s).limits.currentWindowCost,"current-requests":e(s).limits.currentWindowRequests,"current-tokens":e(s).limits.currentWindowTokens,label:"时间窗口限制","rate-limit-window":e(s).limits.rateLimitWindow,"request-limit":e(s).limits.rateLimitRequests,"show-progress":!0,"show-tooltip":!0,"token-limit":e(s).limits.tokenLimit,"window-end-time":e(s).limits.windowEndTime,"window-remaining-seconds":e(s).limits.windowRemainingSeconds,"window-start-time":e(s).limits.windowStartTime},null,8,["cost-limit","current-cost","current-requests","current-tokens","rate-limit-window","request-limit","token-limit","window-end-time","window-remaining-seconds","window-start-time"]),t("div",va,[o[17]||(o[17]=t("i",{class:"fas fa-info-circle mr-1"},null,-1)),e(s).limits.rateLimitCost>0?(r(),i("span",ba,' 请求次数和费用限制为"或"的关系，任一达到限制即触发限流 ')):e(s).limits.tokenLimit>0?(r(),i("span",_a,' 请求次数和Token使用量为"或"的关系，任一达到限制即触发限流 ')):(r(),i("span",ha," 仅限制请求次数 "))])])):D("",!0),t("div",ka,[t("div",$a,[o[19]||(o[19]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"并发限制",-1)),t("span",wa,[e(s).limits.concurrencyLimit>0?(r(),i("span",Sa,a(e(s).limits.concurrencyLimit),1)):(r(),i("span",Ca,o[18]||(o[18]=[t("i",{class:"fas fa-infinity text-gray-400"},null,-1)])))])]),t("div",Ta,[o[22]||(o[22]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"模型限制",-1)),t("span",La,[u.value?(r(),i("span",Ka,[o[20]||(o[20]=t("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),h(" 限制 "+a(e(s).restrictions.restrictedModels.length)+" 个模型 ",1)])):(r(),i("span",Pa,o[21]||(o[21]=[t("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),h(" 允许所有模型 ",-1)])))])]),t("div",Ma,[t("div",Aa,[o[25]||(o[25]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"客户端限制",-1)),t("span",Ia,[v.value?(r(),i("span",Da,[o[23]||(o[23]=t("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),h(" 限 "+a(e(s).restrictions.allowedClients.length)+" 种客户端使用 ",1)])):(r(),i("span",qa,o[24]||(o[24]=[t("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),h(" 允许所有客户端 ",-1)])))])]),v.value?(r(),i("div",Ua,[(r(!0),i(z,null,H(e(s).restrictions.allowedClients,P=>(r(),i("span",{key:P,class:"flex items-center gap-1 rounded-full bg-white px-2 py-1 text-xs text-blue-700 shadow-sm dark:bg-slate-900 dark:text-blue-300 md:text-sm"},[o[26]||(o[26]=t("i",{class:"fas fa-id-badge"},null,-1)),h(" "+a(P),1)]))),128))])):D("",!0)])])]))]),u.value?(r(),i("div",Ra,[o[30]||(o[30]=t("h3",{class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},[t("i",{class:"fas fa-list-alt mr-2 text-sm text-amber-500 md:mr-3 md:text-base"}),h(" 详细限制信息 ")],-1)),t("div",Oa,[o[28]||(o[28]=t("h4",{class:"mb-2 flex items-center text-sm font-bold text-amber-800 dark:text-amber-300 md:mb-3 md:text-base"},[t("i",{class:"fas fa-robot mr-1 text-xs md:mr-2 md:text-sm"}),h(" 受限模型列表 ")],-1)),t("div",ja,[(r(!0),i(z,null,H(e(s).restrictions.restrictedModels,P=>(r(),i("div",{key:P,class:"rounded border border-amber-200 bg-white px-2 py-1 text-xs dark:border-amber-700 dark:bg-gray-800 md:px-3 md:py-2 md:text-sm"},[o[27]||(o[27]=t("i",{class:"fas fa-ban mr-1 text-xs text-red-500 md:mr-2"},null,-1)),t("span",Na,a(P),1)]))),128))]),o[29]||(o[29]=t("p",{class:"mt-2 text-xs text-amber-700 dark:text-amber-400 md:mt-3"},[t("i",{class:"fas fa-info-circle mr-1"}),h(" 此 API Key 不能访问以上列出的模型 ")],-1))])])):D("",!0)]))}},Fa=Q(Ea,[["__scopeId","data-v-4e85e423"]]),Wa={class:"card h-full p-4 md:p-6"},Ba={class:"mb-3 flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:mb-4 md:text-xl"},Va={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},za={key:0,class:"space-y-2 md:space-y-3"},Ja={class:"mb-1 flex items-center justify-between text-sm"},Ya={class:"truncate font-medium text-gray-700 dark:text-gray-300"},Ha={class:"text-xs text-gray-600 dark:text-gray-400"},Ga={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Qa={class:"mt-1 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},Xa={key:0,class:"border-t border-gray-200 pt-2 dark:border-gray-700"},Za={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400"},tl={key:1,class:"flex h-32 items-center justify-center text-sm text-gray-500 dark:text-gray-400"},el={key:2,class:"flex h-32 items-center justify-center text-sm text-gray-500 dark:text-gray-400"},sl={__name:"AggregatedStatsCard",setup(F){const p=X(),{aggregatedStats:s,individualStats:x,statsPeriod:m,multiKeyMode:f}=G(p),u=w=>w?m.value==="daily"?w.dailyUsage||w.usage:w.monthlyUsage||w.usage:null,v=W(()=>!x.value||x.value.length===0?[]:[...x.value].sort((w,k)=>{const d=u(w),o=u(k);return((o==null?void 0:o.cost)||0)-((d==null?void 0:d.cost)||0)}).slice(0,5)),b=W(()=>x.value?Math.max(0,x.value.length-5):0),M=W(()=>{var o,P;if(!x.value||!s.value)return 0;const w=v.value.reduce((N,L)=>{const $=u(L);return N+(($==null?void 0:$.cost)||0)},0),k=m.value==="daily"?((o=s.value.dailyUsage)==null?void 0:o.cost)||0:((P=s.value.monthlyUsage)==null?void 0:P.cost)||0;if(k===0)return 0;const d=k-w;return Math.max(0,Math.round(d/k*100))}),y=w=>{var P,N;if(!s.value)return 0;const k=m.value==="daily"?((P=s.value.dailyUsage)==null?void 0:P.cost)||0:((N=s.value.monthlyUsage)==null?void 0:N.cost)||0;if(k===0)return 0;const d=u(w),o=((d==null?void 0:d.cost)||0)/k*100;return Math.round(o)},S=w=>["bg-blue-500","bg-green-500","bg-purple-500","bg-yellow-500","bg-pink-500"][w]||"bg-gray-400",U=w=>(typeof w!="number"&&(w=parseInt(w)||0),w===0?"0":w>=1e6?(w/1e6).toFixed(1)+"M":w>=1e3?(w/1e3).toFixed(1)+"K":w.toLocaleString());return(w,k)=>(r(),i("div",Wa,[t("h3",Ba,[k[0]||(k[0]=t("span",{class:"flex items-center"},[t("i",{class:"fas fa-chart-pie mr-2 text-sm text-orange-500 md:mr-3 md:text-base"}),h(" 使用占比 ")],-1)),t("span",Va,"("+a(e(m)==="daily"?"今日":"本月")+")",1)]),e(s)&&e(x).length>0?(r(),i("div",za,[(r(!0),i(z,null,H(v.value,(d,o)=>{var P,N;return r(),i("div",{key:d.apiId,class:"relative"},[t("div",Ja,[t("span",Ya,a(d.name||`Key ${o+1}`),1),t("span",Ha,a(y(d))+"% ",1)]),t("div",Ga,[t("div",{class:R(["h-2 rounded-full transition-all duration-300",S(o)]),style:tt({width:y(d)+"%"})},null,6)]),t("div",Qa,[t("span",null,a(U(((P=u(d))==null?void 0:P.requests)||0))+"次",1),t("span",null,a(((N=u(d))==null?void 0:N.formattedCost)||"$0.00"),1)])])}),128)),b.value>0?(r(),i("div",Xa,[t("div",Za,[t("span",null,"其他 "+a(b.value)+" 个Keys",1),t("span",null,a(M.value)+"%",1)])])):D("",!0)])):e(f)?(r(),i("div",el,k[2]||(k[2]=[t("i",{class:"fas fa-chart-pie mr-2"},null,-1),h(" 暂无数据 ",-1)]))):(r(),i("div",tl,k[1]||(k[1]=[t("div",{class:"text-center"},[t("i",{class:"fas fa-chart-pie mb-2 text-2xl"}),t("p",null,"使用占比仅在多Key查询时显示")],-1)])))]))}},al=Q(sl,[["__scopeId","data-v-39572a8e"]]),ll={class:"card p-4 md:p-6"},rl={class:"mb-4 md:mb-6"},il={class:"flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:text-xl"},ol={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},nl={key:0,class:"py-6 text-center md:py-8"},dl={key:1,class:"space-y-3 md:space-y-4"},cl={class:"mb-2 flex items-start justify-between md:mb-3"},ul={class:"min-w-0 flex-1"},ml={class:"break-all text-base font-bold text-gray-900 dark:text-gray-100 md:text-lg"},gl={class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},fl={class:"ml-3 flex-shrink-0 text-right"},xl={class:"text-base font-bold text-green-600 md:text-lg"},yl={class:"grid grid-cols-2 gap-2 text-xs md:grid-cols-4 md:gap-3 md:text-sm"},pl={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},vl={class:"font-medium text-gray-900 dark:text-gray-100"},bl={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},_l={class:"font-medium text-gray-900 dark:text-gray-100"},hl={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},kl={class:"font-medium text-gray-900 dark:text-gray-100"},$l={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},wl={class:"font-medium text-gray-900 dark:text-gray-100"},Sl={key:2,class:"py-6 text-center text-gray-500 dark:text-gray-400 md:py-8"},Cl={class:"text-sm md:text-base"},Tl={__name:"ModelUsageStats",setup(F){const p=X(),{statsPeriod:s,modelStats:x,modelStatsLoading:m}=G(p),f=u=>(typeof u!="number"&&(u=parseInt(u)||0),u===0?"0":u>=1e6?(u/1e6).toFixed(1)+"M":u>=1e3?(u/1e3).toFixed(1)+"K":u.toLocaleString());return(u,v)=>(r(),i("div",ll,[t("div",rl,[t("h3",il,[v[0]||(v[0]=t("span",{class:"flex items-center"},[t("i",{class:"fas fa-robot mr-2 text-sm text-indigo-500 md:mr-3 md:text-base"}),h(" 模型使用统计 ")],-1)),t("span",ol,"("+a(e(s)==="daily"?"今日":"本月")+")",1)])]),e(m)?(r(),i("div",nl,v[1]||(v[1]=[t("i",{class:"fas fa-spinner loading-spinner mb-2 text-xl text-gray-600 dark:text-gray-400 md:text-2xl"},null,-1),t("p",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"加载模型统计数据中...",-1)]))):e(x).length>0?(r(),i("div",dl,[(r(!0),i(z,null,H(e(x),(b,M)=>{var y;return r(),i("div",{key:M,class:"model-usage-item"},[t("div",cl,[t("div",ul,[t("h4",ml,a(b.model),1),t("p",gl,a(b.requests)+" 次请求 ",1)]),t("div",fl,[t("div",xl,a(((y=b.formatted)==null?void 0:y.total)||"$0.000000"),1),v[2]||(v[2]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},"总费用",-1))])]),t("div",yl,[t("div",pl,[v[3]||(v[3]=t("div",{class:"text-gray-600 dark:text-gray-400"},"输入 Token",-1)),t("div",vl,a(f(b.inputTokens)),1)]),t("div",bl,[v[4]||(v[4]=t("div",{class:"text-gray-600 dark:text-gray-400"},"输出 Token",-1)),t("div",_l,a(f(b.outputTokens)),1)]),t("div",hl,[v[5]||(v[5]=t("div",{class:"text-gray-600 dark:text-gray-400"},"缓存创建",-1)),t("div",kl,a(f(b.cacheCreateTokens)),1)]),t("div",$l,[v[6]||(v[6]=t("div",{class:"text-gray-600 dark:text-gray-400"},"缓存读取",-1)),t("div",wl,a(f(b.cacheReadTokens)),1)])])])}),128))])):(r(),i("div",Sl,[v[7]||(v[7]=t("i",{class:"fas fa-chart-pie mb-3 text-2xl md:text-3xl"},null,-1)),t("p",Cl," 暂无"+a(e(s)==="daily"?"今日":"本月")+"模型使用数据 ",1)]))]))}},Ll=Q(Tl,[["__scopeId","data-v-b3b8dc5f"]]),Kl={class:"usage-logs-container"},Pl={class:"mb-4 flex items-center justify-between border-b border-gray-200 pb-4 dark:border-gray-700"},Ml=["disabled"],Al={key:0,class:"flex justify-center py-12"},Il={key:1,class:"rounded-lg bg-red-50 p-4 text-red-800 dark:bg-red-900/20 dark:text-red-200"},Dl={key:2},ql={class:"summary-grid mb-4 grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-5"},Ul={class:"summary-card"},Rl={class:"summary-value"},Ol={class:"summary-card"},jl={class:"summary-value text-green-600 dark:text-green-400"},Nl={class:"summary-card"},El={class:"summary-value"},Fl={class:"summary-card"},Wl={class:"summary-value"},Bl={class:"summary-card"},Vl={class:"summary-value"},zl={class:"logs-table-container overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},Jl={class:"w-full"},Yl={class:"divide-y divide-gray-200 dark:divide-gray-700"},Hl={class:"table-cell whitespace-nowrap"},Gl={class:"flex flex-col gap-0.5"},Ql={class:"text-xs font-medium text-gray-900 dark:text-gray-100"},Xl={class:"text-xs text-gray-500 dark:text-gray-400"},Zl={class:"table-cell"},tr={class:"model-badge"},er={class:"table-cell text-right"},sr={class:"token-badge"},ar={class:"table-cell text-right"},lr={class:"token-badge"},rr={class:"table-cell text-right"},ir={key:0,class:"cache-badge"},or={key:1,class:"text-gray-400"},nr={class:"table-cell text-right"},dr={key:0,class:"cache-badge"},cr={key:1,class:"text-gray-400"},ur={class:"table-cell text-right font-semibold text-gray-900 dark:text-gray-100"},mr={class:"table-cell text-right"},gr={class:"cost-badge"},fr={class:"table-cell"},xr={key:0,class:"flex flex-col gap-0.5"},yr={class:"text-xs text-gray-600 dark:text-gray-300"},pr={class:"font-mono text-xs text-gray-400 dark:text-gray-500"},vr={key:1,class:"text-gray-400"},br={class:"mt-4 flex items-center justify-between"},_r={class:"text-sm text-gray-600 dark:text-gray-400"},hr={class:"flex gap-2"},kr=["disabled"],$r=["disabled"],wr={key:3,class:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400"},Sr={__name:"UsageLogs",setup(F,{expose:p}){const s=X(),{apiId:x,apiKey:m}=G(s),f=I([]),u=I(!1),v=I(null),b=I({total:0,limit:50,offset:0,hasMore:!1}),M=I({totalCost:0,formattedCost:"$0.000000",totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0}),y=W(()=>b.value.limit),S=W(()=>b.value.offset),U=async()=>{if(!x.value&&!m.value){v.value="请先输入 API Key 或 API ID";return}u.value=!0,v.value=null;try{const L=await V.getUsageLogs({apiId:x.value||void 0,apiKey:m.value||void 0,limit:b.value.limit,offset:b.value.offset});L.success?(f.value=L.data.records,b.value=L.data.pagination,M.value=L.data.summary):v.value=L.message||"加载失败"}catch(L){console.error("Failed to load usage logs:",L),v.value=L.message||"加载使用日志失败"}finally{u.value=!1}},w=()=>{b.value.hasMore&&(b.value.offset+=b.value.limit,U())},k=()=>{b.value.offset>0&&(b.value.offset=Math.max(0,b.value.offset-b.value.limit),U())},d=L=>L?L.toLocaleString():"0",o=L=>L?L.replace("claude-3-5-sonnet-","sonnet-").replace("claude-3-opus-","opus-").replace("claude-3-haiku-","haiku-"):"unknown",P=L=>L?new Date(L).toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}):"-",N=L=>L?new Date(L).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return xt([x,m],()=>{b.value.offset=0,f.value=[],M.value={totalCost:0,formattedCost:"$0.000000",totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0},(x.value||m.value)&&U()}),p({loadUsageLogs:U}),(L,$)=>(r(),i("div",Kl,[t("div",Pl,[$[1]||($[1]=t("div",{class:"flex items-center gap-2"},[t("i",{class:"fas fa-history text-lg text-purple-500"}),t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},"使用日志")],-1)),t("button",{class:"refresh-button flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all",disabled:u.value,onClick:U},[t("i",{class:R(["fas fa-sync-alt",{"fa-spin":u.value}])},null,2),$[0]||($[0]=h(" 刷新 ",-1))],8,Ml)]),u.value&&!f.value.length?(r(),i("div",Al,$[2]||($[2]=[t("div",{class:"flex items-center gap-3"},[t("i",{class:"fas fa-spinner fa-spin text-2xl text-purple-500"}),t("span",{class:"text-gray-600 dark:text-gray-300"},"加载中...")],-1)]))):v.value?(r(),i("div",Il,[$[3]||($[3]=t("i",{class:"fas fa-exclamation-triangle mr-2"},null,-1)),h(" "+a(v.value),1)])):f.value.length>0?(r(),i("div",Dl,[t("div",ql,[t("div",Ul,[$[4]||($[4]=t("div",{class:"summary-label"},"总请求数",-1)),t("div",Rl,a(b.value.total),1)]),t("div",Ol,[$[5]||($[5]=t("div",{class:"summary-label"},"总费用",-1)),t("div",jl,a(M.value.formattedCost),1)]),t("div",Nl,[$[6]||($[6]=t("div",{class:"summary-label"},"总 Tokens",-1)),t("div",El,a(d(M.value.totalTokens)),1)]),t("div",Fl,[$[7]||($[7]=t("div",{class:"summary-label"},"输入 Tokens",-1)),t("div",Wl,a(d(M.value.totalInputTokens)),1)]),t("div",Bl,[$[8]||($[8]=t("div",{class:"summary-label"},"输出 Tokens",-1)),t("div",Vl,a(d(M.value.totalOutputTokens)),1)])]),t("div",zl,[t("table",Jl,[$[9]||($[9]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"table-header"},"时间"),t("th",{class:"table-header"},"模型"),t("th",{class:"table-header text-right"},"输入"),t("th",{class:"table-header text-right"},"输出"),t("th",{class:"table-header text-right"},"缓存创建"),t("th",{class:"table-header text-right"},"缓存读取"),t("th",{class:"table-header text-right"},"总计"),t("th",{class:"table-header text-right"},"费用"),t("th",{class:"table-header"},"账户")])],-1)),t("tbody",Yl,[(r(!0),i(z,null,H(f.value,(A,O)=>(r(),i("tr",{key:O,class:"log-row"},[t("td",Hl,[t("div",Gl,[t("span",Ql,a(P(A.timestamp)),1),t("span",Xl,a(N(A.timestamp)),1)])]),t("td",Zl,[t("div",tr,a(o(A.model)),1)]),t("td",er,[t("span",sr,a(d(A.inputTokens)),1)]),t("td",ar,[t("span",lr,a(d(A.outputTokens)),1)]),t("td",rr,[A.cacheCreateTokens>0?(r(),i("span",ir,a(d(A.cacheCreateTokens)),1)):(r(),i("span",or,"-"))]),t("td",nr,[A.cacheReadTokens>0?(r(),i("span",dr,a(d(A.cacheReadTokens)),1)):(r(),i("span",cr,"-"))]),t("td",ur,a(d(A.totalTokens)),1),t("td",mr,[t("span",gr,"$"+a(A.cost.toFixed(6)),1)]),t("td",fr,[A.accountId?(r(),i("div",xr,[t("span",yr,a(A.accountType||"unknown"),1),t("span",pr,a(A.accountId.substring(0,8))+"... ",1)])):(r(),i("span",vr,"-"))])]))),128))])])]),t("div",br,[t("div",_r," 显示 "+a(S.value+1)+"-"+a(Math.min(S.value+y.value,b.value.total))+" / 共 "+a(b.value.total)+" 条 ",1),t("div",hr,[t("button",{class:"pagination-button",disabled:S.value===0||u.value,onClick:k},$[10]||($[10]=[t("i",{class:"fas fa-chevron-left"},null,-1),h(" 上一页 ",-1)]),8,kr),t("button",{class:"pagination-button",disabled:!b.value.hasMore||u.value,onClick:w},$[11]||($[11]=[h(" 下一页 ",-1),t("i",{class:"fas fa-chevron-right"},null,-1)]),8,$r)])])])):(r(),i("div",wr,$[12]||($[12]=[t("i",{class:"fas fa-inbox mb-3 text-4xl"},null,-1),t("p",null,"暂无使用日志",-1)])))]))}},Cr=Q(Sr,[["__scopeId","data-v-58e41aeb"]]),Tr={class:"glass-strong mb-6 rounded-3xl p-4 shadow-xl md:mb-8 md:p-6"},Lr={class:"flex flex-col items-center justify-between gap-4 md:flex-row"},Kr={class:"flex items-center gap-2 md:gap-4"},Pr={class:"flex items-center"},Mr={key:0,class:"h-8 w-px bg-gradient-to-b from-transparent via-gray-300 to-transparent opacity-50 dark:via-gray-600"},Ar={class:"mb-6 md:mb-8"},Ir={class:"flex justify-center"},Dr={class:"inline-flex w-full max-w-md rounded-full border border-white/20 bg-white/10 p-1 shadow-lg backdrop-blur-xl md:w-auto"},qr={key:0,class:"tab-content"},Ur={key:0,class:"mb-6 md:mb-8"},Rr={class:"rounded-xl border border-red-500/30 bg-red-500/20 p-3 text-sm text-red-800 backdrop-blur-sm dark:border-red-500/20 dark:bg-red-500/10 dark:text-red-200 md:p-4 md:text-base"},Or={key:1,class:"fade-in"},jr={class:"glass-strong rounded-3xl p-4 shadow-xl md:p-6"},Nr={class:"mb-4 border-b border-gray-200 pb-4 dark:border-gray-700 md:mb-6 md:pb-6"},Er={class:"flex flex-col items-start justify-between gap-3 md:flex-row md:items-center md:gap-4"},Fr={class:"flex w-full gap-2 md:w-auto"},Wr=["disabled"],Br=["disabled"],Vr={class:"mb-6 mt-6 grid grid-cols-1 gap-4 md:mb-8 md:mt-8 md:gap-6 xl:grid-cols-2 xl:items-stretch"},zr={class:"mt-6 md:mt-8"},Jr={key:1,class:"tab-content"},Yr={class:"glass-strong rounded-3xl shadow-xl"},Hr={__name:"ApiStatsView",setup(F){const p=bt(),s=X(),x=kt(),m=I("stats"),f=W(()=>x.isDarkMode),{apiKey:u,apiId:v,loading:b,modelStatsLoading:M,oemLoading:y,error:S,statsPeriod:U,statsData:w,oemSettings:k,multiKeyMode:d}=G(s),{queryStats:o,switchPeriod:P,loadStatsWithApiId:N,loadOemSettings:L,reset:$}=s,A=O=>{(O.ctrlKey||O.metaKey)&&O.key==="Enter"&&(!b.value&&u.value.trim()&&o(),O.preventDefault()),O.key==="Escape"&&$()};return vt(()=>{x.initTheme(),L();const O=p.query.apiId,C=p.query.apiKey;O&&O.match(/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i)?(v.value=O,N()):C&&C.length>10&&(u.value=C),document.addEventListener("keydown",A)}),_t(()=>{document.removeEventListener("keydown",A)}),xt(u,O=>{O||s.clearData()}),(O,C)=>{const Z=ht("router-link");return r(),i("div",{class:R(["min-h-screen p-4 md:p-6",f.value?"gradient-bg-dark":"gradient-bg"])},[t("div",Tr,[t("div",Lr,[Y($t,{loading:e(y),"logo-src":e(k).siteIconData||e(k).siteIcon,subtitle:m.value==="stats"?"API Key 使用统计":"使用教程",title:e(k).siteName},null,8,["loading","logo-src","subtitle","title"]),t("div",Kr,[t("div",Pr,[Y(wt,{mode:"dropdown"})]),e(k).ldapEnabled||e(k).showAdminButton!==!1?(r(),i("div",Mr)):D("",!0),e(k).ldapEnabled?(r(),lt(Z,{key:1,class:"user-login-button flex items-center gap-2 rounded-2xl px-4 py-2 text-white transition-all duration-300 md:px-5 md:py-2.5",to:"/user-login"},{default:ft(()=>C[4]||(C[4]=[t("i",{class:"fas fa-user text-sm md:text-base"},null,-1),t("span",{class:"text-xs font-semibold tracking-wide md:text-sm"},"用户登录",-1)])),_:1,__:[4]})):D("",!0),e(k).showAdminButton!==!1?(r(),lt(Z,{key:2,class:"admin-button-refined flex items-center gap-2 rounded-2xl px-4 py-2 transition-all duration-300 md:px-5 md:py-2.5",to:"/dashboard"},{default:ft(()=>C[5]||(C[5]=[t("i",{class:"fas fa-shield-alt text-sm md:text-base"},null,-1),t("span",{class:"text-xs font-semibold tracking-wide md:text-sm"},"管理后台",-1)])),_:1,__:[5]})):D("",!0)])])]),t("div",Ar,[t("div",Ir,[t("div",Dr,[t("button",{class:R(["tab-pill-button",m.value==="stats"?"active":""]),onClick:C[0]||(C[0]=J=>m.value="stats")},C[6]||(C[6]=[t("i",{class:"fas fa-chart-line mr-1 md:mr-2"},null,-1),t("span",{class:"text-sm md:text-base"},"统计查询",-1)]),2),t("button",{class:R(["tab-pill-button",m.value==="tutorial"?"active":""]),onClick:C[1]||(C[1]=J=>m.value="tutorial")},C[7]||(C[7]=[t("i",{class:"fas fa-graduation-cap mr-1 md:mr-2"},null,-1),t("span",{class:"text-sm md:text-base"},"使用教程",-1)]),2)])])]),m.value==="stats"?(r(),i("div",qr,[Y(Yt),e(S)?(r(),i("div",Ur,[t("div",Rr,[C[8]||(C[8]=t("i",{class:"fas fa-exclamation-triangle mr-2"},null,-1)),h(" "+a(e(S)),1)])])):D("",!0),e(w)?(r(),i("div",Or,[t("div",jr,[t("div",Nr,[t("div",Er,[C[11]||(C[11]=t("div",{class:"flex items-center gap-2 md:gap-3"},[t("i",{class:"fas fa-clock text-base text-blue-500 md:text-lg"}),t("span",{class:"text-base font-medium text-gray-700 dark:text-gray-200 md:text-lg"},"统计时间范围")],-1)),t("div",Fr,[t("button",{class:R(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:e(U)==="daily"}]]),disabled:e(b)||e(M),onClick:C[2]||(C[2]=J=>e(P)("daily"))},C[9]||(C[9]=[t("i",{class:"fas fa-calendar-day text-xs md:text-sm"},null,-1),h(" 今日 ",-1)]),10,Wr),t("button",{class:R(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:e(U)==="monthly"}]]),disabled:e(b)||e(M),onClick:C[3]||(C[3]=J=>e(P)("monthly"))},C[10]||(C[10]=[t("i",{class:"fas fa-calendar-alt text-xs md:text-sm"},null,-1),h(" 本月 ",-1)]),10,Br)])])]),Y(gs),t("div",Vr,[Y(Ms,{class:"h-full"}),e(d)?(r(),lt(al,{key:0,class:"h-full"})):(r(),lt(Fa,{key:1,class:"h-full"}))]),Y(Ll),t("div",zr,[Y(Cr)])])])):D("",!0)])):D("",!0),m.value==="tutorial"?(r(),i("div",Jr,[t("div",Yr,[Y(Tt)])])):D("",!0)],2)}}},li=Q(Hr,[["__scopeId","data-v-3c178bd3"]]);export{li as default};
